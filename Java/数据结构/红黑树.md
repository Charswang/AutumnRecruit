### 红黑树原理【应该就是把平衡二叉树的几种方式+二叉搜索树结合起来，实现<font color="orange">自平衡</font>。】

> 平衡二叉查找树的一种：【**<font color="orange">自平衡</font>**的二叉查找树】
>
> 针对二叉查找树多次插入新节点导致的不平衡问题，出现红黑树。
>
> 【假设初始的二叉查找树只有三个节点，根节点值为9，左孩子值为8，右孩子值为12：接下来我们依次插入如下五个节点：7,6,5,4,3。依照二叉查找树的特性，结果会变成左边的子节点变得很长，二叉查找树严重不平衡，出现**线性查找的问题，没有了二叉查找树的优势。**】

- 节点分为红色节点和黑色节点
- 根节点是黑色的
- 叶子节点都是黑色的
- 如果节点是红色节点，则其子节点是黑色节点，不能出现连续的红色节点。（**反之则不一定**）
- **<font color="orange">从根节点到叶节点或空子节点的每条路径，必须包含相同数目的黑色节点（即相同的黑色高度）。</font>**

> 整个红黑树的高度是logN

![红黑树结构](D:\Data\AutumnRecruit\Java\数据结构\image\红黑树结构.jpg)

---

#### 调整方式【如果插入数据/删除数据之后，树不再符合红黑树的规则，则就需要重新调整一下】

- **变色**

  为了重新符合红黑树的规则，尝试把红色节点变为黑色，或者把黑色节点变为红色。

- **旋转**【[平衡二叉树旋转](https://cloud.tencent.com/developer/article/1419168)】

  > 通过旋转可以降低树的高度

  - 左旋转

    待旋转的节点从右边上升到父节点就是左旋。

  - 右旋转

    待旋转的节点从左边上升到父节点就是右旋。

  - 左右旋、右左旋？？

![红黑树旋转](D:\Data\AutumnRecruit\Java\数据结构\image\红黑树旋转.png)

#### 插入和删除操作  --  【https://zhuanlan.zhihu.com/p/24367771】

- **插入操作**

  **<font color="orange">新插入的节点是红色的。</font>**

  插入修复操作如果遇到父节点的颜色为黑则修复操作结束。也就是说，只有在**<font color="orange">父节点为红色节点的时候是需要插入修复</font>**操作的。

  ##### [-- 三种情况 --]***具体情况下看参考链接***

  - 1、*叔叔节点也为红色。*

    ![红黑树插入情况1](D:\Data\AutumnRecruit\Java\数据结构\image\红黑树插入情况1.png)

  - 2、*叔叔节点为空，且祖父节点、父节点和新节点处于一条斜线上。*

    ![红黑树插入情况2](D:\Data\AutumnRecruit\Java\数据结构\image\红黑树插入情况2.png)

  - 3、*叔叔节点为空，且祖父节点、父节点和新节点不处于一条斜线上。*

    ![红黑树插入情况3](D:\Data\AutumnRecruit\Java\数据结构\image\红黑树插入情况3.png)

- **删除操作**

  ​        如果是**<font color="orange">叶子节点</font>**就直接删除

  ​        如果是**<font color="orange">非叶子节点</font>**，会用对应的**<font color="orange">中序遍历的后继节点</font>**来顶替要删除节点的位置。删除后就需要做**<font color="orange">删除修复操作</font>**，使的树符合红黑树的定义，符合定义的红黑树高度是平衡的。

  ​	   <font color="orange">删除修复操作在遇到被删除的节点是红色节点或者到达root节点时，修复操作完毕。</font>

  ​       <font color="orange">删除修复操作是针对删除黑色节点才有的</font>

  > **<font color="lightblue">从兄弟节点上借调黑色的节点过来，如果兄弟节点没有黑节点可以借调的话，就只能往上追溯，将每一级的黑节点数减去一个，使得整棵树符合红黑树的定义。</font>**
  >
  > 删除操作的总体思想是从兄弟节点借调黑色节点使树保持局部的平衡，如果局部的平衡达到了，就看整体的树是否是平衡的，如果不平衡就接着向上追溯调整。

  **[-- 三种情况 --]** --***具体情况下看参考链接***

  - 1、*待删除的节点的兄弟节点是红色的节点。*

    ![红黑树删除情况1](D:\Data\AutumnRecruit\Java\数据结构\image\红黑树删除情况1.png)

  - 2、*待删除的节点的兄弟节点是黑色的节点，且兄弟节点的子节点都是黑色的。*

    ![红黑树删除情况2](D:\Data\AutumnRecruit\Java\数据结构\image\红黑树删除情况2.png)

  - 3、*待调整的节点的兄弟节点是黑色的节点，且兄弟节点的左子节点是红色的，右节点是黑色的(兄弟节点在右边)，如果兄弟节点在左边的话，就是兄弟节点的右子节点是红色的，左节点是黑色的。*

    ![红黑树删除情况3](D:\Data\AutumnRecruit\Java\数据结构\image\红黑树删除情况3.png)

  - 4、*待调整的节点的兄弟节点是黑色的节点，且右子节点是是红色的(兄弟节点在右边)，如果兄弟节点在左边，则就是对应的就是左节点是红色的。*

    ![红黑树删除情况4](D:\Data\AutumnRecruit\Java\数据结构\image\红黑树删除情况4.png)

  

---

### 红黑树面试参考

https://www.cnblogs.com/wuchanming/p/4444961.html